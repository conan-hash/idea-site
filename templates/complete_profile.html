{% extends 'public_base.html' %}
{% load widget_tweaks %}
{% load error_filter %}

{% block title %}فعال‌سازی اکانت{% endblock %}

{% block content %}
<main id="main" class="main">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card shadow-lg p-4">
          <!-- Header -->
          <div class="text-center mb-4">
            <h2 class="card-title fw-bold">تکمیل پروفایل</h2>
            <p class="text-muted">لطفا اطلاعات خود را با دقت وارد کنید.</p>
          </div>

          <!-- Form -->
          <form method="post" novalidate
          >
            {% csrf_token %}
            <div class="row mb-3">
              <label for="fullName" class="col-md-4 col-lg-3 col-form-label">نام</label>
              <div class="col-md-8 col-lg-9">
                {{ form.first_name }}
                {% if form.first_name.errors %}
                <div class="text-danger">
                  {% for error in form.first_name.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
              </div>
            </div>

            <div class="row mb-3">
              <label for="fullName" class="col-md-4 col-lg-3 col-form-label">نام خانوادگی</label>
              <div class="col-md-8 col-lg-9">
                {{ form.last_name }}
                {% if form.last_name.errors %}
                <div class="text-danger">
                  {% for error in form.last_name.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
              </div>
            </div>

            <div class="row mb-3">
              <label for="national_id" class="col-md-4 col-lg-3 col-form-label">کد ملی</label>
              <div class="col-md-8 col-lg-9">
                {{ form.national_id }}
                {% if form.national_id.errors %}
                <div class="text-danger">
                  {% for error in form.national_id.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
              </div>
            </div>

            <div class="row mb-3">
              <label for="major" class="col-md-4 col-lg-3 col-form-label">رشته تحصیلی</label>
              <div class="col-md-8 col-lg-9">
                {{ form.major }}
                {% if form.major.errors %}
                <div class="text-danger">
                  {% for error in form.major.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
              </div>
            </div>

            <div class="row mb-3">
              <label for="company" class="col-md-4 col-lg-3 col-form-label">دانشگاه/شرکت</label>
              <div class="col-md-8 col-lg-9">
                {{ form.work_place }}
                {% if form.work_place.errors %}
                <div class="text-danger">
                  {% for error in form.work_place.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
              </div>
            </div>

            <div class="row mb-3">
              <label for="Job" class="col-md-4 col-lg-3 col-form-label">شغل</label>
              <div class="col-md-8 col-lg-9">
                {{ form.job }}
                {% if form.job.errors %}
                <div class="text-danger">
                  {% for error in form.job.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
              </div>
            </div>

            <div class="row mb-3">
              <label for="Phone" class="col-md-4 col-lg-3 col-form-label">تلفن</label>
              <div class="col-md-8 col-lg-9">
                {{ form.phone_number }}
                {% if form.phone_number.errors %}
                <div class="text-danger">
                  {% for error in form.phone_number.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
              </div>
            </div>


            <div class="row mb-3">
              <label class="col-md-4 col-lg-3 col-form-label">آیا شما در شرکت بید بلند کار میکنید؟</label>
              <div class="col-md-8 col-lg-9">
                {% for radio in form.works_at_company %}
                  <div class="form-check form-check-inline">
                    {{ radio.tag }}
                    <label class="form-check-label">{{ radio.choice_label }}</label>
                  </div>
                {% endfor %}
                {% if form.works_at_company.errors %}
                  <div clsss="text-danger">
                      {% for error in form.works_at_company.errors %}
                        {{ error }}
                      {% endfor %}
                  </div>
                  {% endif %}
              </div>
            </div>

            <div class="row mb-3" style="display: none;" id="personnel_number_field">
              <label for="Email" class="col-md-4 col-lg-3 col-form-label">شماره پرسنلی</label>
              <div class="col-md-8 col-lg-9">
                {{ form.personnel_number }}
                {% if form.personnel_number.errors %}
                <div class="text-danger">
                  {% for error in form.personnel_number.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
              </div>
            </div>

            <div class="text-center">
              <button type="submit" class="btn btn-primary">ثبت اطلاعات</button>
            </div>
          </form><!-- End Profile Edit Form -->
        </div>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const personnelNumberField = document.getElementById('personnel_number_field'); 

      // Function to toggle visibility
      function togglePersonnelNumberField() {
        const selectedValue = document.querySelector('input[name="works_at_company"]:checked').value;
        if (selectedValue === 'yes') {
          personnelNumberField.style.display = 'flex'; // Show the field
        } else {
          personnelNumberField.style.display = 'none'; // Hide the field
          personnelNumberField.querySelector("input").value = "";
        }
      }

      // Add event listeners to radio buttons
      document.querySelectorAll('input[name="works_at_company"]').forEach(radio => {
        radio.addEventListener("change", togglePersonnelNumberField);
      });

      // Initialize visibility on page load
      togglePersonnelNumberField();
    });
  </script>
</main>
{% endblock %}